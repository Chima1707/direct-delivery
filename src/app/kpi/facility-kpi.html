<div class="page-header">
  <h1>Facility KPI</h1>
</div>
<div class="panel panel-default">
  <div class="panel-body">
    <a ui-sref="home.schedule"
       class="btn btn-default btn-lg btn-block">
      <i class="fa fa-arrow-circle-left"></i>
      <span>Back</span>
    </a>
    <button type="button" class="btn btn-default btn-lg btn-block"
            ng-show="facKPICtrl.previewKPI"
            ng-click="facKPICtrl.togglePreview()">
      <i class="fa fa-arrow-circle-left"></i>
      <span>Back</span>
    </button>
    <br/>
    <div class="row">
      <div class="col-xs-6">
        <input type="date"
               class="form-control input-lg"
               ng-model="facDevCtrl.selectedDate"/>
      </div>
    </div>

    <br/>

    <table class="table table-striped table-condensed table-bordered">
      <tr>
        <th class="col-sm-2">Antigen</th>
        <th class="col-sm-2">No. of people immunized</th>
      </tr>
      <tr ng-repeat="antigen in facDevCtrl.facilityKPI.antigensKPI track by $index">
        <td><span ng-bind="antigen.productID"></span></td>
        <td>
          <input type="number"
                 class="form-control input-sm"
                 min="0"
                 ng-change="facKPICtrl.validateNoImmunized($index)"
                 ng-model="facDevCtrl.facilityKPI.antigensKPI[$index].noImmunized"
                 ng-disabled="facKPICtrl.previewKPI"
                 step="1"
                 ng-model-options="{updateOn: 'blur'}"/>
          <span class="text-danger" ng-show="facKPICtrl.kpiError.antigensNoImmunized[antigen.productID] === true">
            <em>
              <i class="fa fa-exclamation-circle"></i>
              Please, enter number of people immunized.
            </em>
        </span>
        </td>
      </tr>
    </table>

    <form>
      <div class="form-group">
        <label>No. of Outreach Sessions
          <input type="number" class="form-control input-sm-6"
                 ng-model="facDevCtrl.facilityKPI.outreachSessions"
                 ng-change="facKPICtrl.isValidOutreach()"
                 ng-disabled="facKPICtrl.previewKPI"
                 min="0"
                 step="1">
        </label>
        <br/>
        <span class="alert-danger"
              ng-show="facKPICtrl.kpiError.outreach === true">
            <em>
              <i class="fa fa-exclamation-circle"></i>
              Please, enter number of outreach sessions.
            </em>
        </span>
      </div>
      <div class="form-group">
        <label>Notes (optional) </label>
        <textarea class="form-control"
                  ng-model="facDevCtrl.facilityKPI.notes"
                  ng-disabled="facKPICtrl.previewKPI"
                  rows="3">
        </textarea>
      </div>
      <button type="button"
              class="btn btn-success btn-lg btn-block"
              ng-show="!facKPICtrl.previewKPI"
              ng-click="facKPICtrl.preview(facDevCtrl.facilityKPI)">
        <span>Preview</span>
        <i class="fa fa-arrow-circle-right"></i>
      </button>
      <button type="submit"
              class="btn btn-success btn-lg btn-block"
              ng-show="facKPICtrl.previewKPI">
        <i class="fa fa-floppy-o"></i>
        <span>Submit</span>
      </button>
    </form>
  </div>
</div>
